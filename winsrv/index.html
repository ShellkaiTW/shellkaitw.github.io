<!doctype html>
<html lang="zh-TW">
  <head prefix="og: https://ogp.me/ns#">
    <meta charset="utf-8" />
    <meta name="generator" content="gh:importantimport/urara" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="manifest" crossorigin="use-credentials" href="/manifest.webmanifest" />
    <link rel="alternate" type="application/feed+json" href="/feed.json" />
    <link rel="alternate" type="application/atom+xml" href="/atom.xml" />
    <link rel="sitemap" type="application/xml" href="/sitemap.xml" />
    <meta http-equiv="content-security-policy" content="style-src 'self' 'unsafe-inline' https://giscus.app">
		<link href="../_app/immutable/assets/0.DSMd5aeZ.css" rel="stylesheet">
		<link href="../_app/immutable/assets/posts.C6CGrAZI.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.D-aG5tYi.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/entry.9NQay4Lh.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/scheduler.BWDpjmD3.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index.DIUoT-SP.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.BHQ_ItW5.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/preload-helper.BQ24v_F8.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index.D6J2XlmR.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.VSFig01S.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/posts.CDWtigex.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/icon.C1b6mlfy.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/8.C-FswkKV.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/post_layout.DbraLVnE.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/footer.DMSQUgXx.js"><title>Windows Server | Shellkai's Blog</title><!-- HEAD_svelte-1592q3p_START --><!-- HEAD_svelte-1592q3p_END --><!-- HEAD_svelte-1kxdj3d_START --><link rel="shortcut icon" href="https://localhost:5173/kon-favicon.png" sizes="48x48" type="image/png"><link rel="apple-touch-icon" href="https://localhost:5173/assets/any@180.png" sizes="180x180" type="image/png"><link rel="icon" href="https://localhost:5173/assets/any@192.png" sizes="192x192" type="image/png"><!-- HEAD_svelte-1kxdj3d_END --><!-- HEAD_svelte-1g590ms_START --><meta name="theme-color"><!-- HEAD_svelte-1g590ms_END --><!-- HEAD_svelte-abrfj_START --><meta name="author" content="Shellkai Huang"><link rel="canonical" href="https://localhost:5173/winsrv">  <meta name="keywords" content="Windows, OS"> <!-- HEAD_svelte-abrfj_END --><!-- HEAD_svelte-4dky5b_START --><meta property="og:site_name" content="Shellkai's Blog"><meta property="og:locale" content="zh-TW"><meta property="og:type" content="article"> <meta property="og:title" content="Windows Server">  <meta property="og:image" content="https://localhost:5173/winsrv.jpg"> <meta name="twitter:card" content="summary_large_image"> <meta property="article:tag" content="Windows"><meta property="article:tag" content="OS"> <meta property="og:url" content="https://localhost:5173/winsrv"> <meta property="article:author" content="Shellkai Huang"> <meta property="article:published_time" content="2024-09-16T00:00:00.000Z"> <meta property="article:modified_time" content="2024-09-16T00:00:00.000Z"><!-- HEAD_svelte-4dky5b_END -->
  </head>
  <body itemscope itemtype="https://schema.org/WebPage">
    <div style="display: contents">      <header id="header" class="fixed z-50 w-full transition-all duration-500 ease-in-out border-b-2 border-transparent max-h-[4.125rem] false"><div class="navbar"><div class="navbar-start">  <div class="dropdown lg:hidden"><label for="navbar-dropdown" tabindex="0" class="btn btn-square btn-ghost" data-svelte-h="svelte-rz1qrs"><span class="i-heroicons-outline-menu-alt-1"></span></label> <ul id="navbar-dropdown" tabindex="0" class="menu menu-compact dropdown-content bg-base-100 text-base-content shadow-lg rounded-box min-w-max max-w-52 p-2"><li><a href="/">Home</a> </li><li><a href="/hello-world/about_me">About</a> </li></ul></div> <div class="swap order-last hidden lg:inline-grid"><button class="swap-on btn btn-ghost text-base font-normal normal-case transition-all duration-200 hidden"></button> <ul class="swap-off menu menu-horizontal p-0"><li><a class="!rounded-btn" href="/">Home</a> </li><li><a class="!rounded-btn" href="/hello-world/about_me">About</a> </li></ul></div> <a href="/" class="btn btn-ghost normal-case text-lg">Shellkai's Blog</a></div> <div class="navbar-end"> <div id="change-theme" class="dropdown dropdown-end">  <div tabindex="0" class="btn btn-square btn-ghost" data-svelte-h="svelte-1qtp8cz"><span class="i-heroicons-outline-color-swatch"></span></div>   <ul tabindex="0" class="flex flex-nowrap shadow-2xl menu dropdown-content bg-base-100 text-base-content rounded-box w-52 p-2 gap-2 overflow-y-auto max-h-[21.5rem]"><button data-theme="cmyk" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">🖨 Light</p> <div class="grid grid-cols-4 gap-0.5 m-auto"><div class="bg-primary w-1 h-4 rounded-btn"></div><div class="bg-secondary w-1 h-4 rounded-btn"></div><div class="bg-accent w-1 h-4 rounded-btn"></div><div class="bg-neutral w-1 h-4 rounded-btn"></div></div> </button><button data-theme="dracula" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">🧛 Dark</p> <div class="grid grid-cols-4 gap-0.5 m-auto"><div class="bg-primary w-1 h-4 rounded-btn"></div><div class="bg-secondary w-1 h-4 rounded-btn"></div><div class="bg-accent w-1 h-4 rounded-btn"></div><div class="bg-neutral w-1 h-4 rounded-btn"></div></div> </button><button data-theme="valentine" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">🌸 Valentine</p> <div class="grid grid-cols-4 gap-0.5 m-auto"><div class="bg-primary w-1 h-4 rounded-btn"></div><div class="bg-secondary w-1 h-4 rounded-btn"></div><div class="bg-accent w-1 h-4 rounded-btn"></div><div class="bg-neutral w-1 h-4 rounded-btn"></div></div> </button><button data-theme="aqua" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">💦 Aqua</p> <div class="grid grid-cols-4 gap-0.5 m-auto"><div class="bg-primary w-1 h-4 rounded-btn"></div><div class="bg-secondary w-1 h-4 rounded-btn"></div><div class="bg-accent w-1 h-4 rounded-btn"></div><div class="bg-neutral w-1 h-4 rounded-btn"></div></div> </button><button data-theme="synthwave" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">🌃 Synthwave</p> <div class="grid grid-cols-4 gap-0.5 m-auto"><div class="bg-primary w-1 h-4 rounded-btn"></div><div class="bg-secondary w-1 h-4 rounded-btn"></div><div class="bg-accent w-1 h-4 rounded-btn"></div><div class="bg-neutral w-1 h-4 rounded-btn"></div></div> </button><button data-theme="night" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">🌃 Night</p> <div class="grid grid-cols-4 gap-0.5 m-auto"><div class="bg-primary w-1 h-4 rounded-btn"></div><div class="bg-secondary w-1 h-4 rounded-btn"></div><div class="bg-accent w-1 h-4 rounded-btn"></div><div class="bg-neutral w-1 h-4 rounded-btn"></div></div> </button><button data-theme="lofi" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">🎶 Lo-Fi</p> <div class="grid grid-cols-4 gap-0.5 m-auto"><div class="bg-primary w-1 h-4 rounded-btn"></div><div class="bg-secondary w-1 h-4 rounded-btn"></div><div class="bg-accent w-1 h-4 rounded-btn"></div><div class="bg-neutral w-1 h-4 rounded-btn"></div></div> </button><button data-theme="lemonade" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">🍋 Lemonade</p> <div class="grid grid-cols-4 gap-0.5 m-auto"><div class="bg-primary w-1 h-4 rounded-btn"></div><div class="bg-secondary w-1 h-4 rounded-btn"></div><div class="bg-accent w-1 h-4 rounded-btn"></div><div class="bg-neutral w-1 h-4 rounded-btn"></div></div> </button><button data-theme="cupcake" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">🧁 Cupcake</p> <div class="grid grid-cols-4 gap-0.5 m-auto"><div class="bg-primary w-1 h-4 rounded-btn"></div><div class="bg-secondary w-1 h-4 rounded-btn"></div><div class="bg-accent w-1 h-4 rounded-btn"></div><div class="bg-neutral w-1 h-4 rounded-btn"></div></div> </button><button data-theme="garden" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">🏡 Garden</p> <div class="grid grid-cols-4 gap-0.5 m-auto"><div class="bg-primary w-1 h-4 rounded-btn"></div><div class="bg-secondary w-1 h-4 rounded-btn"></div><div class="bg-accent w-1 h-4 rounded-btn"></div><div class="bg-neutral w-1 h-4 rounded-btn"></div></div> </button><button data-theme="retro" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">🌇 Retro</p> <div class="grid grid-cols-4 gap-0.5 m-auto"><div class="bg-primary w-1 h-4 rounded-btn"></div><div class="bg-secondary w-1 h-4 rounded-btn"></div><div class="bg-accent w-1 h-4 rounded-btn"></div><div class="bg-neutral w-1 h-4 rounded-btn"></div></div> </button><button data-theme="black" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">🖤 Black</p> <div class="grid grid-cols-4 gap-0.5 m-auto"><div class="bg-primary w-1 h-4 rounded-btn"></div><div class="bg-secondary w-1 h-4 rounded-btn"></div><div class="bg-accent w-1 h-4 rounded-btn"></div><div class="bg-neutral w-1 h-4 rounded-btn"></div></div> </button></ul></div></div></div></header> <button id="totop" aria-label="scroll to top" class="fixed grid group btn btn-circle btn-lg border-none backdrop-blur bottom-6 right-6 z-50 duration-500 ease-in-out btn-ghost bg-base-100/30 md:bg-base-200/30 translate-y-24"> <div class="radial-progress text-accent transition-all duration-500 ease-in-out group-hover:text-[color-mix(in_oklab,oklch(var(--a)),black_7%)] col-start-1 row-start-1" style="--size:4rem; --thickness: 0.25rem; --value:undefined;"></div> <div class="border-4 border-base-content/10 group-hover:border-transparent col-start-1 row-start-1 rounded-full w-full h-full p-4 grid duration-500 ease-in-out" data-svelte-h="svelte-hwvjh5"><span class="i-heroicons-solid-chevron-up !w-6 !h-6"></span></div></button> <div class="bg-base-100 md:bg-base-200 min-h-screen pt-16 md:pb-8 lg:pb-16">  <div class="flex flex-col flex-nowrap justify-center xl:flex-row xl:flex-wrap"><div class="flex-1 w-full order-first ease-out transform mx-auto xl:mr-0 xl:ml-0"></div> <div class="flex-1 w-full xl:order-last ease-out transform mx-auto xl:ml-0 xl:mr-0"></div> <div class="flex-none w-full max-w-screen-md mx-auto xl:mx-0"><article itemscope itemtype="https://schema.org/BlogPosting" itemprop="blogPost" class="h-entry card bg-base-100 rounded-none md:rounded-box md:shadow-xl overflow-hidden z-10 md:mb-8 lg:mb-16">   <div class="card-body gap-0 "><div class="flex flex-col gap-2"><figure class="md:order-last rounded-box shadow-xl mb-4 flex-col gap-2 -mx-4 -mt-8 md:mt-0"><picture><source srcset="/_app/immutable/assets/winsrv.HEB0qMqJ.avif 736w" type="image/avif"> <img src="/winsrv.jpg" alt="/winsrv.jpg" class="u-featured" loading="lazy" decoding="async"></picture></figure> <div class="flex font-semibold gap-1.5"><a rel="author" class="opacity-75 hover:opacity-100 hover:text-primary duration-500 ease-in-out p-author h-card" href="https://localhost:5173">Shellkai Huang</a> <span class="opacity-50" data-svelte-h="svelte-1edzios">/</span> <a href="/winsrv" class="u-url u-uid swap group/time"><time class="group-hover/time:opacity-0 font-semibold opacity-75 duration-500 ease-in-out mr-auto dt-published" datetime="2024-09-16T00:00:00.000Z" itemprop="datePublished">24年9月16日 星期一</time> <time class="opacity-0 group-hover/time:opacity-100 font-semibold text-primary duration-500 ease-in-out mr-auto dt-updated" datetime="2024-09-16T00:00:00.000Z" itemprop="dateModified">24年9月16日 星期一</time></a></div> <h1 itemprop="name headline" class="card-title text-3xl mb-8 p-name">Windows Server</h1> </div> <main itemprop="articleBody" class="urara-prose prose e-content"><h2 id="gpo-相關設定" data-svelte-h="svelte-6z2xkb"><a href="#gpo-相關設定">GPO 相關設定</a></h2> <h3 id="初次登錄動畫關閉" data-svelte-h="svelte-dhtil8"><a href="#初次登錄動畫關閉">初次登錄動畫關閉</a></h3> <p data-svelte-h="svelte-5hga6e">打開 GPO，找到「<strong>Administrative Templates\System\Logon</strong>」中的「<strong>Show first sign-in animation</strong>」，設定為 <strong>Disable</strong>，再執行 <code>gpupdate /force</code>來立即套用更新</p> <h3 id="禁止存取控制台設定" data-svelte-h="svelte-1xaqksb"><a href="#禁止存取控制台設定">禁止存取控制台設定</a></h3> <p>GPO -&gt; User Configuration -&gt; Policies -&gt; Administrative Templetes -&gt; Control Panel -&gt; 設定 Prohibit access to Control Panel and PC settings 為 <strong data-svelte-h="svelte-tra0oh">Enabled</strong> <img src="https://hackmd.io/_uploads/HJi2R6hqh.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h3 id="限制或禁止使用者使用特定應用程式" data-svelte-h="svelte-epwre2"><a href="#限制或禁止使用者使用特定應用程式">限制或禁止使用者使用特定應用程式</a></h3> <p>GPO -&gt; User Configuration -&gt; Administrative Templetes -&gt; System -&gt; 設定 Don’t run specified Windows applications
<img src="https://hackmd.io/_uploads/Sy5jSED03.png" alt="https://hackmd.io/_uploads/Sy5jSED03.png" class="rounded-lg my-2" loading="lazy" decoding="async">
設定為 <strong data-svelte-h="svelte-tra0oh">Enabled</strong>，並點選 List of disallowed applications，在 Value 欄位設定要禁用的應用程式
<img src="https://hackmd.io/_uploads/HkgS8Vw02.png" alt="https://hackmd.io/_uploads/HkgS8Vw02.png" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h3 id="設定在-logon-ui-看不到上個登入的使用者" data-svelte-h="svelte-lnk77j"><a href="#設定在-logon-ui-看不到上個登入的使用者">設定在 Logon UI 看不到上個登入的使用者</a></h3> <p>GPO -&gt; Computer Configuration -&gt; Policies -&gt; Administrative Templetes -&gt; System -&gt; Logon -&gt; 設定 Block user from showing account details on sign-in 為 <strong data-svelte-h="svelte-tra0oh">Enabled</strong> <img src="https://hackmd.io/_uploads/rkMTCT2q2.png" alt="https://hackmd.io/_uploads/rkMTCT2q2.png" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h3 id="登入時自動掛載共享資料夾" data-svelte-h="svelte-12i782l"><a href="#登入時自動掛載共享資料夾">登入時自動掛載共享資料夾</a></h3> <p data-svelte-h="svelte-924v4l">Step 1. 製作 Bash Script</p> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="="><div class='code-container'><code>// 掛載 \windc.nsc49.skills.twweb 網路位置到電腦，且磁碟代號為 W:
net use W: /delete
net use W: \windc.nsc49.skills.twweb</code></div></pre><!-- Note from shiki-twoslash: the language bash== was not set up for Shiki to use, and so there is no code highlighting --><!-- HTML_TAG_END --> <p>Step 2. 用 GPO 設定讓此指令在登入時自動執行
新增 GPO -&gt; User Configuration -&gt; Policies -&gt; Windows Settings -&gt; Script (Logon/Logoff) -&gt; Logon -&gt; Add -&gt; Browse -&gt; 將 Script 丟至彈出的資料夾 -&gt; 選擇後點選 OK
<img src="https://hackmd.io/_uploads/rkd1JRhq2.png" alt="https://hackmd.io/_uploads/rkd1JRhq2.png" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/ryScekxjp.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
註：最好放在下面「Show Files…」的資料夾內，否則有機率腳本會無法生效</p> <h3 id="若共享資料夾有跨網域" data-svelte-h="svelte-lz2frv"><a href="#若共享資料夾有跨網域">若共享資料夾有跨網域</a></h3> <p data-svelte-h="svelte-1e9k50f">只需讓 Script 使用網域管理員身分登入即可：</p> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="="><div class='code-container'><code>// 掛載 \windc.nsc49.skills.twweb 網路位置到電腦，且磁碟代號為 W:，使用 AD/Administrator 身分來登入
net use W: /delete
net use W: \windc.nsc49.skills.twweb /user:ADAdministrator Skills39 /p:yes</code></div></pre><!-- Note from shiki-twoslash: the language bash== was not set up for Shiki to use, and so there is no code highlighting --><!-- HTML_TAG_END --> <h3 id="讓-windows-server-也能掛載-debian-smbd" data-svelte-h="svelte-k62u4a"><a href="#讓-windows-server-也能掛載-debian-smbd">讓 Windows Server 也能掛載 Debian SMBD</a></h3> <p>Local GPO -&gt; Computer Configuration -&gt; Administrative Templates -&gt; Network -&gt; Lanman Workstation -&gt; 設定 Enable insecure guest logons 為 <strong data-svelte-h="svelte-tra0oh">Enabled</strong> <img src="https://hackmd.io/_uploads/rynWy0n92.png" alt="https://hackmd.io/_uploads/rynWy0n92.png" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h3 id="gpo-個別使用者套用規則" data-svelte-h="svelte-19caf4p"><a href="#gpo-個別使用者套用規則">GPO 個別使用者套用規則</a></h3> <p>若要指定特別使用者套用 Group Policy (刪除 Authentication Users)，至少要保留一台 Computer (最好是 Server 和 Client 都保留)
<img src="https://hackmd.io/_uploads/SJMjm3FRT.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h3 id="開機時自動跳出訊息" data-svelte-h="svelte-hofbxf"><a href="#開機時自動跳出訊息">開機時自動跳出訊息</a></h3> <p>GPO -&gt; Computer Configuration -&gt; Windows Settings -&gt; Security Settings -&gt; Local Policy -&gt; Security Options
<img src="https://hackmd.io/_uploads/r15ckli0T.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/SyCi61j0T.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/H1zjyeiRa.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
當電腦準備登入時會顯示：
<img src="https://hackmd.io/_uploads/S1MRyejRp.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h3 id="禁止使用-windows-update" data-svelte-h="svelte-1bqfzki"><a href="#禁止使用-windows-update">禁止使用 Windows Update</a></h3> <p>GPO -&gt; Computer Configuration -&gt; Administrative Templates -&gt; Windows Components -&gt; Windows Update -&gt; 設定 Remove access to use all Windows Update features 為 <strong data-svelte-h="svelte-tra0oh">Enabled</strong> <img src="https://hackmd.io/_uploads/BJ7flZjC6.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
效果：
<img src="https://hackmd.io/_uploads/SJl3gGbsR6.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h3 id="登入時自動將檔案複製到桌面" data-svelte-h="svelte-1pm9i5y"><a href="#登入時自動將檔案複製到桌面">登入時自動將檔案複製到桌面</a></h3> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="="><div class='code-container'><code>// 將 PuTTY 複製到使用者的桌面上
copy C:putty.exe %USERPROFILE%Desktop
// %USERPROFILE% 指的是當前登入使用者的 User 目錄</code></div></pre><!-- Note from shiki-twoslash: the language bash== was not set up for Shiki to use, and so there is no code highlighting --><!-- HTML_TAG_END --> <p data-svelte-h="svelte-15ocirl">寫好後將檔案另存為 cmd，可參照上面的步驟套用於 GPO</p> <h3 id="用指令載入登錄檔" data-svelte-h="svelte-eeh9bo"><a href="#用指令載入登錄檔">用指令載入登錄檔</a></h3> <p>將登錄機碼匯出為 <code data-svelte-h="svelte-1f6dfg">.reg</code> 格式的檔案：右鍵 -&gt; Export -&gt; 選擇路徑
<img src="https://hackmd.io/_uploads/H1HquOl1C.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="="><div class='code-container'><code>reg import [reg_file].reg</code></div></pre><!-- Note from shiki-twoslash: the language bash== was not set up for Shiki to use, and so there is no code highlighting --><!-- HTML_TAG_END --> <p data-svelte-h="svelte-1rf15va">另存為 cmd，一樣可以套用於 GPO</p> <h2 id="dns" data-svelte-h="svelte-1ygr0y3"><a href="#dns">DNS</a></h2> <h3 id="dns-快取紀錄關閉" data-svelte-h="svelte-1ipv3j1"><a href="#dns-快取紀錄關閉">DNS 快取紀錄關閉</a></h3> <p data-svelte-h="svelte-1oz3ht5">按一下 Windows Key + R，輸入 regedit 後 Enter
設定「<strong>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Dnscache</strong>」中的 <strong>Start</strong> 值為 4，重啟後即可關閉 DNS 快取紀錄</p> <h3 id="dns-同步" data-svelte-h="svelte-ayfpyk"><a href="#dns-同步">DNS 同步</a></h3> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">DC：192.168.39.10 (Primary DNS)</span></div><div class='line'><span style="color: undefined">SRV：192.168.39.20 (Secondary DNS)</span></div></code></div></pre><!-- HTML_TAG_END --> <p>先允許 Primary DNS 跟 Secondary DNS 的 Zone Transfer 功能
DC：
<img src="https://hackmd.io/_uploads/r1KPerlC6.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
SRV：
<img src="https://hackmd.io/_uploads/SyOQWHgRp.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
選擇域名按右鍵 -&gt; Transfer new copy of zone from Master
<img src="https://hackmd.io/_uploads/r1rqWSgRp.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
即可完成同步</p> <p data-svelte-h="svelte-11bnbis">若要設定自動同步項可以看下方的 SOA</p> <h4 id="通知-notify" data-svelte-h="svelte-zysikv"><a href="#通知-notify">通知 (Notify)</a></h4> <p>在 Primary DNS 上設定當記錄發生變化時通知 Secondary DNS
<img src="https://hackmd.io/_uploads/SJ3xUBlAT.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
設定 Secondary DNS 可以接收 Notify
<img src="https://hackmd.io/_uploads/B10Uvrg0p.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h4 id="start-of-authority-record-soa" data-svelte-h="svelte-1pq0ti3"><a href="#start-of-authority-record-soa">Start of Authority Record (SOA)</a></h4> <p><img src="https://hackmd.io/_uploads/rkkD_HxAT.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
Refresh interval：Secondary DNS 多久向 Primary DNS 伺服器同步
Retry interval：當 Secondary DNS 向 Primary DNS 同步但無法連線到 Primary DNS，多久後重試
Expires after：當 Secondary DNS 無法連線到 Primary DNS 會一直重試，如果重試超過到期時間就放棄重試
Minimum TTL：當其它 DNS 伺服器查詢這個網域的記錄時，資料儲存在對方伺服器快取中的時間 (若在到期前若對方伺服器又收到相同查詢就會直接回應快取中的資料)</p> <h3 id="conditional-forwarders" data-svelte-h="svelte-ofr1m5"><a href="#conditional-forwarders">Conditional Forwarders</a></h3> <p>與 Forward 功能相似，但是可以指定網域傳送到指定伺服器
<img src="https://hackmd.io/_uploads/S13rUWy_A.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/rJTtLWJu0.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
DNS Domain：當收到這個網域的 DNS Request 時送到指定的 DNS Servers
IP addresses of the master servers：指定網域的 DNS Servers</p> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">本地 DNS：wsc2024.tw / 172.16.20.10</span></div><div class='line'><span style="color: undefined">遠端 DNS：worldskills.org / 8.8.8.8</span></div></code></div></pre><!-- HTML_TAG_END --> <p><img src="https://hackmd.io/_uploads/ByeFwZkO0.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/B1uqDZkuA.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h2 id="使用者設定-cmd--for-loop" data-svelte-h="svelte-i385jf"><a href="#使用者設定-cmd--for-loop">使用者設定 (cmd &amp; for loop)</a></h2> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="="><div class='code-container'><code>//加入九個使用者，名稱為 IT01~IT09
for /l %a in (1 1 9) do net user IT0%a /add
//加入九個使用者，名稱為 HQ01~HQ09，密碼為 Skills39
for /l %a in (1 1 9) do net user HQ0%a Skills39 /add
//刪除使用者
net user [username] /del</code></div></pre><!-- Note from shiki-twoslash: the language bash== was not set up for Shiki to use, and so there is no code highlighting --><!-- HTML_TAG_END --> <h2 id="進階使用者設定-powershell--for-loop" data-svelte-h="svelte-gtdgk0"><a href="#進階使用者設定-powershell--for-loop">進階使用者設定 (PowerShell &amp; for loop)</a></h2> <h3 id="set-aduser" data-svelte-h="svelte-4np15j"><a href="#set-aduser">Set-ADUser</a></h3> <p data-svelte-h="svelte-1jmolw9">通常是使用者的細項資料設定才會用到</p> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="="><div class='code-container'><code>//將 FA001~009 九個使用者的 Display Name 設定為 Flight Attendant 001~009
1..9 | % &#123; Set-ADUser -Identity FA00$_ -DisplayName "Flight Attendant 00$_" &#125;
// "$_" 是一個特殊的 PowerShell 自動變數，代表執行中的腳本或指令所傳遞過來的變數</code></div></pre><!-- Note from shiki-twoslash: the language bash== was not set up for Shiki to use, and so there is no code highlighting --><!-- HTML_TAG_END --> <p><img src="https://hackmd.io/_uploads/By0zKd-NA.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <p>若忘記指令也可透過 PowerShell IDE 尋找指令
<img src="https://hackmd.io/_uploads/HyFtKuZEA.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h3 id="dsmod" data-svelte-h="svelte-12dfwjr"><a href="#dsmod">dsmod</a></h3> <p data-svelte-h="svelte-1rk2d4">dsmod 與 Set-ADUser 的功能相同
先使用 <code>dsquery</code> 指令列出所有的完整使用者名稱 (包含所屬網域等參數)，在使用 <code>dsmod</code> 指令時需要</p> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="="><div class='code-container'><code>dsquery user
// 列出所有使用者完整名稱</code></div></pre><!-- Note from shiki-twoslash: the language bash== was not set up for Shiki to use, and so there is no code highlighting --><!-- HTML_TAG_END --> <p><img src="https://hackmd.io/_uploads/ryT_7DHO0.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="="><div class='code-container'><code>dsmod user /?
// 可查看所有 dsmod 可修改的參數及表示方式</code></div></pre><!-- Note from shiki-twoslash: the language bash== was not set up for Shiki to use, and so there is no code highlighting --><!-- HTML_TAG_END --> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="="><div class='code-container'><code>dsmod user [full_user_name] -office "IT Manager"
// 將使用者的 Office 參數改為 IT Manager</code></div></pre><!-- Note from shiki-twoslash: the language bash== was not set up for Shiki to use, and so there is no code highlighting --><!-- HTML_TAG_END --> <p><img src="https://hackmd.io/_uploads/Sy5WNDrO0.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/BkozEwHOA.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h2 id="群組設定-cmd--for-loop" data-svelte-h="svelte-927kq7"><a href="#群組設定-cmd--for-loop">群組設定 (cmd &amp; for loop)</a></h2> <p data-svelte-h="svelte-12obcyg">通常僅會在 Windows Server 題目中沒有要求做 Active Directory 時才會用到</p> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="="><div class='code-container'><code>//新增群組
net localgroup [groupname] /add
//將 IT01~09 共九人加入 IT 群組
for /l %a in (1 1 9) do net localgroup IT IT0%a /add
//將使用者移出群組
net localgroup [groupname] [username] /del
//重新命名群組
wmic group where name="[oldname]" rename [newname]
//檢查群組內的使用者
net localgroup [groupname]</code></div></pre><!-- Note from shiki-twoslash: the language bash== was not set up for Shiki to use, and so there is no code highlighting --><!-- HTML_TAG_END --> <p data-svelte-h="svelte-1sf15ix">PS：若群組名稱或使用者名稱有空格，需要用雙引號(&quot;&quot;)括起來</p> <h3 id="一次允許多個可使用遠端桌面的使用者" data-svelte-h="svelte-1pnrob9"><a href="#一次允許多個可使用遠端桌面的使用者">一次允許多個可使用遠端桌面的使用者</a></h3> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="="><div class='code-container'><code>//將 IT01~09 共九人允許使用遠端桌面連線
for /l %a in (1 1 9) do net localgroup "Remote Desktop Users" IT0%a /add</code></div></pre><!-- Note from shiki-twoslash: the language bash== was not set up for Shiki to use, and so there is no code highlighting --><!-- HTML_TAG_END --> <h2 id="允許-icmp-協議" data-svelte-h="svelte-jb9b1l"><a href="#允許-icmp-協議">允許 ICMP 協議</a></h2> <p>進入 Control Panel -&gt; Windows Defender Firewall -&gt; Advenced settings
<img src="https://hackmd.io/_uploads/r1s-A6n5n.png" alt="https://hackmd.io/_uploads/r1s-A6n5n.png" class="rounded-lg my-2" loading="lazy" decoding="async">
選 Inbound rules -&gt; New Rule
<img src="https://hackmd.io/_uploads/HJnfR63qh.png" alt="https://hackmd.io/_uploads/HJnfR63qh.png" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/HyVQAa252.png" alt="https://hackmd.io/_uploads/HyVQAa252.png" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/S1hQ0ph92.png" alt="https://hackmd.io/_uploads/S1hQ0ph92.png" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/SyQE0a352.png" alt="https://hackmd.io/_uploads/SyQE0a352.png" class="rounded-lg my-2" loading="lazy" decoding="async">
選擇 ICMP：
<img src="https://hackmd.io/_uploads/By64063q3.png" alt="https://hackmd.io/_uploads/By64063q3.png" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/B1SBAah9n.png" alt="https://hackmd.io/_uploads/B1SBAah9n.png" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/BkvUATnch.png" alt="https://hackmd.io/_uploads/BkvUATnch.png" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/S1zwC6nqn.png" alt="https://hackmd.io/_uploads/S1zwC6nqn.png" class="rounded-lg my-2" loading="lazy" decoding="async">
即完成 ICMP 設定
<img src="https://hackmd.io/_uploads/SkSuCT3c2.png" alt="https://hackmd.io/_uploads/SkSuCT3c2.png" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h2 id="讓網域內電腦自動信任-ca-憑證" data-svelte-h="svelte-1hgj8bt"><a href="#讓網域內電腦自動信任-ca-憑證">讓網域內電腦自動信任 CA 憑證</a></h2> <h3 id="允許自動信任設定" data-svelte-h="svelte-1bn527i"><a href="#允許自動信任設定">允許自動信任設定</a></h3> <p>打開 Group Policy Management -&gt; Create a GPO in this domain, and Link it here
<img src="https://hackmd.io/_uploads/HkxKAa2cn.png" alt="https://hackmd.io/_uploads/HkxKAa2cn.png" class="rounded-lg my-2" loading="lazy" decoding="async">
選擇 Computer Configuration -&gt; Policies -&gt; Windows Settings -&gt; Security Settings -&gt; Public Keys -&gt; Certificate Services Client - Auto-Enrollmemt
設定 Configuration Model 為 <strong data-svelte-h="svelte-tra0oh">Enabled</strong> <img src="https://hackmd.io/_uploads/SJcKApn93.png" alt="https://hackmd.io/_uploads/SJcKApn93.png" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h3 id="設定自動信任的電腦" data-svelte-h="svelte-12ij8jf"><a href="#設定自動信任的電腦">設定自動信任的電腦</a></h3> <p>選擇 Automatic Certification Settings
右鍵 -&gt; New -&gt; Automatic Certificate Request
<img src="https://hackmd.io/_uploads/BylcRah93.png" alt="https://hackmd.io/_uploads/BylcRah93.png" class="rounded-lg my-2" loading="lazy" decoding="async">
選擇 Computer
<img src="https://hackmd.io/_uploads/BJ550p35h.png" alt="https://hackmd.io/_uploads/BJ550p35h.png" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/H1LoC625n.png" alt="https://hackmd.io/_uploads/H1LoC625n.png" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/r1b2R6hq3.png" alt="https://hackmd.io/_uploads/r1b2R6hq3.png" class="rounded-lg my-2" loading="lazy" decoding="async">
輸入 <code data-svelte-h="svelte-1fy3f7c">gpupdate /force</code> 後，即完成設定
<img src="https://hackmd.io/_uploads/Hkh16KO2h.png" alt="https://hackmd.io/_uploads/Hkh16KO2h.png" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h2 id="共享資料夾管理-file-server-resource-manager" data-svelte-h="svelte-k1pf10"><a href="#共享資料夾管理-file-server-resource-manager">共享資料夾管理 (File Server Resource Manager)</a></h2> <p>安裝 File Server Resource Manager
<img src="https://hackmd.io/_uploads/HJn7SZjnp.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h3 id="限制共享資料夾空間" data-svelte-h="svelte-ch0v1b"><a href="#限制共享資料夾空間">限制共享資料夾空間</a></h3> <p>選擇 Quota Management -&gt; Quotas
<img src="https://hackmd.io/_uploads/BkJdH-snp.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
右鍵 Create Quota
<img src="https://hackmd.io/_uploads/ByeZkR2c2.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
選好要套用的共享資料夾，如果在系統給的選項內沒有題目的條件就用 Custom Properties
<img src="https://hackmd.io/_uploads/HkiIUbihp.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h3 id="限制共享資料夾存放檔案類型" data-svelte-h="svelte-5xvxel"><a href="#限制共享資料夾存放檔案類型">限制共享資料夾存放檔案類型</a></h3> <p><strong data-svelte-h="svelte-p7pb6r">Step 1. 建立檔案類型群組</strong>
選擇 File Screening Management -&gt; File Groups
<img src="https://hackmd.io/_uploads/B1sspZo3a.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
右鍵 Create File Group
<img src="https://hackmd.io/_uploads/HJUj0Wsn6.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
將此群組包含的檔案類型都加到 Files to include 內 (註：＊.exe 代表封鎖全部附檔名為 exe 的檔案)
<img src="https://hackmd.io/_uploads/H1KZRZohT.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <p><strong data-svelte-h="svelte-1ikqcpl">Step 2. 建立禁止檔案類型範本</strong>
選擇 File Screening Management -&gt; File Screen Templates
<img src="https://hackmd.io/_uploads/S1K2hWona.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
右鍵 Create File Screen Template
<img src="https://hackmd.io/_uploads/B1Eiyfona.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"> <strong data-svelte-h="svelte-36j3yp">若顯示錯誤，將虛擬機重開就可解決</strong> <img src="https://hackmd.io/_uploads/ByN_pbs3T.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <p><strong data-svelte-h="svelte-18l87u8">Step 3. 套用範本到共享資料夾</strong>
選擇 File Screening Management -&gt; File Screens
<img src="https://hackmd.io/_uploads/rk0p_-j2a.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
右鍵 Create File Screen
<img src="https://hackmd.io/_uploads/SklXxzj36.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
選好要套用的共享資料夾，並將選項選到剛剛設定的範本
<img src="https://hackmd.io/_uploads/SJGceMoha.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h2 id="快速啟動網路介面控制" data-svelte-h="svelte-1tjaib9"><a href="#快速啟動網路介面控制">快速啟動網路介面控制</a></h2> <p>按一下 Windows Key + R，輸入 ncpa.cpl 後 Enter
<img src="https://hackmd.io/_uploads/HkXDvaLL2.png" alt="https://hackmd.io/_uploads/HkXDvaLL2.png" class="rounded-lg my-2" loading="lazy" decoding="async">
可直接打開控制台網路介面
<img src="https://hackmd.io/_uploads/Hkd38pU8n.png" alt="https://hackmd.io/_uploads/Hkd38pU8n.png" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h2 id="更改-remote-desktop-的-tcp-port-登錄檔修改" data-svelte-h="svelte-fuiknc"><a href="#更改-remote-desktop-的-tcp-port-登錄檔修改">更改 Remote Desktop 的 TCP Port (登錄檔修改)</a></h2> <p>按一下 Windows Key + R，輸入 regedit 後 Enter
在「<strong data-svelte-h="svelte-1f1gqr1">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp</strong>」下，找到「<strong data-svelte-h="svelte-ldgmsq">PortNumber</strong>」選項並編輯其機碼值為欲設定的 Port 後重啟即可
<img src="https://hackmd.io/_uploads/HJckBqzF3.png" alt="https://hackmd.io/_uploads/HJckBqzF3.png" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h2 id="dhcp-server-位址保留" data-svelte-h="svelte-19cxttp"><a href="#dhcp-server-位址保留">DHCP Server 位址保留</a></h2> <p>打開 DHCP -&gt; 選擇要設定的 Scope -&gt; Reservations -&gt; New Reservation
<img src="https://hackmd.io/_uploads/S1EOa9qtn.png" alt="https://hackmd.io/_uploads/S1EOa9qtn.png" class="rounded-lg my-2" loading="lazy" decoding="async">
Reservation name (此保留設定的名稱)
IP address (欲保留的 IP 位址)
MAC address (保留的 IP 要給誰)
Description (描述此保留設定，可略過)
<img src="https://hackmd.io/_uploads/H1BNR9qtn.png" alt="https://hackmd.io/_uploads/H1BNR9qtn.png" class="rounded-lg my-2" loading="lazy" decoding="async">
設定好後，到被保留 IP 的電腦上執行 <code data-svelte-h="svelte-pv0nhz">ipconfig /renew</code> (電腦網卡須設定為 DHCP)
<img src="https://hackmd.io/_uploads/B1yiJi9Y3.png" alt="https://hackmd.io/_uploads/B1yiJi9Y3.png" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h2 id="vpn-設定" data-svelte-h="svelte-1i017zr"><a href="#vpn-設定">VPN 設定</a></h2> <p>新增 VPN 規則，選擇 DirectAccess and VPN (RAS)
<img src="https://hackmd.io/_uploads/BkaBU3Ps3.png" alt="https://hackmd.io/_uploads/BkaBU3Ps3.png" class="rounded-lg my-2" loading="lazy" decoding="async">
重啟後點選 Remote Access Management Console 後再選 RRAS Management console
<img src="https://hackmd.io/_uploads/Sk6283Doh.png" alt="https://hackmd.io/_uploads/Sk6283Doh.png" class="rounded-lg my-2" loading="lazy" decoding="async">
選擇伺服器，右鍵選擇 Configure and Enable Routing and Remote Access
<img src="https://hackmd.io/_uploads/r1CKRvn32.png" alt="https://hackmd.io/_uploads/r1CKRvn32.png" class="rounded-lg my-2" loading="lazy" decoding="async">
選擇 Custom configuration
<img src="https://hackmd.io/_uploads/Hk4b1u32n.png" alt="https://hackmd.io/_uploads/Hk4b1u32n.png" class="rounded-lg my-2" loading="lazy" decoding="async">
選擇 VPN Access 即可
<img src="https://hackmd.io/_uploads/HJKFkO333.png" alt="https://hackmd.io/_uploads/HJKFkO333.png" class="rounded-lg my-2" loading="lazy" decoding="async">
若無設定 DHCP：
設定 VPN 的 Static address pool，並輸入範圍可使用 VPN 的 IP 範圍
<img src="https://hackmd.io/_uploads/rymwDnwih.png" alt="https://hackmd.io/_uploads/rymwDnwih.png" class="rounded-lg my-2" loading="lazy" decoding="async">
(若有設定 DHCP 可直接略過到下一步驟)
回到 Server Manager，選 Tools -&gt; Active Directory Users and Computers
<img src="https://hackmd.io/_uploads/SkhOg5_32.png" alt="https://hackmd.io/_uploads/SkhOg5_32.png" class="rounded-lg my-2" loading="lazy" decoding="async">
選取想要遠端存取的使用者，並右鍵選擇「Add to a group…」
<img src="https://hackmd.io/_uploads/HJJcG9dnh.png" alt="https://hackmd.io/_uploads/HJJcG9dnh.png" class="rounded-lg my-2" loading="lazy" decoding="async">
輸入 Remote 後選擇 Check Names
<img src="https://hackmd.io/_uploads/HJEpX5uhn.png" alt="https://hackmd.io/_uploads/HJEpX5uhn.png" class="rounded-lg my-2" loading="lazy" decoding="async">
選擇 Remote Desktop Users 後，按 OK
<img src="https://hackmd.io/_uploads/Hki8Ncu2h.png" alt="https://hackmd.io/_uploads/Hki8Ncu2h.png" class="rounded-lg my-2" loading="lazy" decoding="async">
選擇 Network Policy Server
<img src="https://hackmd.io/_uploads/BJDHD_323.png" alt="https://hackmd.io/_uploads/BJDHD_323.png" class="rounded-lg my-2" loading="lazy" decoding="async">
點開 Policies -&gt; Network Policies -&gt; New
<img src="https://hackmd.io/_uploads/rJ3fu_nh2.png" alt="https://hackmd.io/_uploads/rJ3fu_nh2.png" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/rJlxvs2nh.png" alt="https://hackmd.io/_uploads/rJlxvs2nh.png" class="rounded-lg my-2" loading="lazy" decoding="async">
設定後在 Client 端上可輸入在群組內使用者的帳號和密碼登入 VPN
若遇到登入失敗的問題或一直卡在連線中：
一樣到 Network Policy Server
<img src="https://hackmd.io/_uploads/H1oKHvx1a.png" alt="https://hackmd.io/_uploads/H1oKHvx1a.png" class="rounded-lg my-2" loading="lazy" decoding="async">
選擇剛剛建立的規則，按右鍵 -&gt; Properties
<img src="https://hackmd.io/_uploads/HJodMwxJa.png" alt="https://hackmd.io/_uploads/HJodMwxJa.png" class="rounded-lg my-2" loading="lazy" decoding="async">
Constraints -&gt; Authentication Methods -&gt; Add… -&gt; 選 Microsoft: Secured password (EAP-MSCHAP v2) -&gt; OK
<img src="https://hackmd.io/_uploads/SJxzrwx16.png" alt="https://hackmd.io/_uploads/SJxzrwx16.png" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/SJ-HIvlyT.png" alt="https://hackmd.io/_uploads/SJ-HIvlyT.png" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h3 id="sstp-設定" data-svelte-h="svelte-9cxdp3"><a href="#sstp-設定">SSTP 設定</a></h3> <h4 id="有-web-server--https" data-svelte-h="svelte-1tqhik2"><a href="#有-web-server--https">有 Web Server + HTTPS</a></h4> <p>如果有 Web Server，SSTP 所使用的憑證需要和 Web Server 一樣
故要簽一張萬用域名(*)的憑證 (若 Web Server 和 SSTP 的 FQDN 不一樣的話)
<img src="https://hackmd.io/_uploads/r1wZT0kD0.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
簽好後到 Server Manager -&gt; Tools -&gt; Routing and Remote Access
<img src="https://hackmd.io/_uploads/HyV4fJew0.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
Server -&gt; 右鍵 -&gt; Properties
<img src="https://hackmd.io/_uploads/HyQXZyxDA.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/B1f0jJlwR.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">先設定 CA Server 的 Certificate Templates</span></div><div class='line'><span style="color: undefined">MMC -&gt; Certificate Templates -&gt; IPSec -&gt; 右鍵 Duplicate Template</span></div><div class='line'><span style="color: undefined">![image](https://hackmd.io/_uploads/SJ0plU-S0.png)</span></div><div class='line'><span style="color: undefined">Request Handling -&gt; 勾選 Allow private key to be exported</span></div><div class='line'><span style="color: undefined">![image](https://hackmd.io/_uploads/HJWMZ8bHR.png)</span></div><div class='line'><span style="color: undefined">Subject Name -&gt; 選擇 Supply in the request</span></div><div class='line'><span style="color: undefined">![image](https://hackmd.io/_uploads/Sy93-8-B0.png)</span></div><div class='line'><span style="color: undefined">Extensions Application -&gt; Edit...</span></div><div class='line'><span style="color: undefined">![image](https://hackmd.io/_uploads/rk9eGUbHR.png)</span></div><div class='line'><span style="color: undefined">Add... -&gt; Server Authentication</span></div><div class='line'><span style="color: undefined">![image](https://hackmd.io/_uploads/r1xVfL-rC.png)![image](https://hackmd.io/_uploads/SyD8GUWSA.png)</span></div><div class='line'><span style="color: undefined">Certificate Templates 設定完成</span></div></code></div></pre><!-- HTML_TAG_END --> <h3 id="radius-驗證伺服器" data-svelte-h="svelte-u4b2z"><a href="#radius-驗證伺服器">RADIUS 驗證伺服器</a></h3> <p>若題目有要求用 AD 使用者帳號驗證，但 VPN 不是安裝在 Domain Contoller 上的時候就會需要 RADIUS
在 Domain Controller 上先安裝 Network Policy and Access Services
<img src="https://hackmd.io/_uploads/HyZMWglPC.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
安裝後 -&gt; 點選 Tools -&gt; Network Policy Server -&gt; NPS (Local)
確認選項是 VPN Connections 後，點選 Configure VPN or Dial-Up
<img src="https://hackmd.io/_uploads/HyF2QegvC.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
選擇 Virtual Private Network (VPN) Connections
<img src="https://hackmd.io/_uploads/BkC-4xlDR.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
Next -&gt; Add…
<img src="https://hackmd.io/_uploads/BkzfBgxw0.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
將被驗證方的資料輸入完後按 Verify…
<img src="https://hackmd.io/_uploads/HyAozexDR.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
再按 Resolve，系統會確定 Client 端是否在線，若在線下面的 IP address 會顯示
<img src="https://hackmd.io/_uploads/ByKLSlew0.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
將三個選項都確認無誤後再下一步
<img src="https://hackmd.io/_uploads/BJYGUeewC.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
接著設定可以使用 VPN 的群組
<img src="https://hackmd.io/_uploads/SyIsLgeDR.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
IP Fliter 可依需求設定，若無需設定直接 Next
<img src="https://hackmd.io/_uploads/SygknxeDA.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
僅勾選 Strongest encryption
<img src="https://hackmd.io/_uploads/HJCGhelDR.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
Realm Name 可直接跳過
<img src="https://hackmd.io/_uploads/rywFnlgv0.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
RADIUS Server 端設定完成，轉到 Client 端
Server Manager -&gt; Tools -&gt; Routing and Remote Access -&gt; 右鍵 Server -&gt; Properties -&gt; Security
將 Authentication provider 和 Accounting provider 都設為 RADIUS Accounting -&gt; Configure…
<img src="https://hackmd.io/_uploads/SkbAvQevC.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
按 New…
<img src="https://hackmd.io/_uploads/HkweuXeDA.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
Server name 輸入 Server 端的 IP Address，Shared secret 輸入在 Server 端設定好的密碼，Accounting provider 的 Configure 也照樣設定
<img src="https://hackmd.io/_uploads/BJqCdXewR.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
按 OK 後就設定完成
<img src="https://hackmd.io/_uploads/S10qtQlwA.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h2 id="讓外部電腦信任根憑證-root-ca" data-svelte-h="svelte-mskw9o"><a href="#讓外部電腦信任根憑證-root-ca">讓外部電腦信任根憑證 (Root CA)</a></h2> <p>在 Windows Server 端的操作：打開 MMC -&gt; 導入 Certificates -&gt; Computer Account -&gt; Local Computer
<img src="https://hackmd.io/_uploads/SyfBYQ8Rh.png" alt="https://hackmd.io/_uploads/SyfBYQ8Rh.png" class="rounded-lg my-2" loading="lazy" decoding="async">
Trusted Root Certificates Authorities -&gt; Certificates -&gt; 選擇要讓外部電腦驗證的根憑證 -&gt; 右鍵 All Tasks -&gt; Export…
<img src="https://hackmd.io/_uploads/rkuU5QUC2.png" alt="https://hackmd.io/_uploads/rkuU5QUC2.png" class="rounded-lg my-2" loading="lazy" decoding="async">
檔案格式選 DER 或 Base-64 則一即可
<img src="https://hackmd.io/_uploads/H1wKc78R2.png" alt="https://hackmd.io/_uploads/H1wKc78R2.png" class="rounded-lg my-2" loading="lazy" decoding="async">
在外部電腦端的操作：打開 MMC -&gt; 導入 Ceritficates -&gt; Computer Account -&gt; Local Computer -&gt; Trusted Root Certificates Authorities -&gt; Ceritficates -&gt; 右鍵 All Tasks -&gt; Import…
<img src="https://hackmd.io/_uploads/H1Ppi7LR2.png" alt="https://hackmd.io/_uploads/H1Ppi7LR2.png" class="rounded-lg my-2" loading="lazy" decoding="async">
選取剛剛自己導出的根憑證
<img src="https://hackmd.io/_uploads/SkJYhXIC3.png" alt="https://hackmd.io/_uploads/SkJYhXIC3.png" class="rounded-lg my-2" loading="lazy" decoding="async">
選擇 Place all ceritificates in the following store，並確認憑證倉庫為「Trusted Root Certificates Authorities」
<img src="https://hackmd.io/_uploads/B1Bq2XLRh.png" alt="https://hackmd.io/_uploads/B1Bq2XLRh.png" class="rounded-lg my-2" loading="lazy" decoding="async">
最後按下 Finish，即安裝完成根憑證，瀏覽內部網站時不會再跳出憑證錯誤等訊息
<img src="https://hackmd.io/_uploads/Skbb6Q8C2.png" alt="https://hackmd.io/_uploads/Skbb6Q8C2.png" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h2 id="windows-11" data-svelte-h="svelte-hu0015"><a href="#windows-11">Windows 11</a></h2> <h3 id="安裝跳過-tpmcpu-和-secure-boot-檢查" data-svelte-h="svelte-1elydqn"><a href="#安裝跳過-tpmcpu-和-secure-boot-檢查">安裝跳過 TPM、CPU 和 Secure Boot 檢查</a></h3> <p><img src="https://hackmd.io/_uploads/HkhM2Fdh3.png" alt="https://hackmd.io/_uploads/HkhM2Fdh3.png" class="rounded-lg my-2" loading="lazy" decoding="async">
進入安裝介面後，按「Shift + F10」叫出 cmd，並輸入 regedit
<img src="https://hackmd.io/_uploads/HJmEkuJn3.png" alt="https://hackmd.io/_uploads/HJmEkuJn3.png" class="rounded-lg my-2" loading="lazy" decoding="async">
找到「<strong data-svelte-h="svelte-yg8poe">Computer\HKEY_LOCAL_MACHINE\SYSTEM\Setup</strong>」
<img src="https://hackmd.io/_uploads/H1pi0Dknh.png" alt="https://hackmd.io/_uploads/H1pi0Dknh.png" class="rounded-lg my-2" loading="lazy" decoding="async">
新增一個「LabConfig」機碼
<img src="https://hackmd.io/_uploads/S1pkxdknn.png" alt="https://hackmd.io/_uploads/S1pkxdknn.png" class="rounded-lg my-2" loading="lazy" decoding="async">
在機碼內部新增三個 DWORD (32-bit) 值，分別為「<strong data-svelte-h="svelte-rt1hp5">BypassTPMCheck</strong>」、「<strong data-svelte-h="svelte-rxzhlz">BypassSecureBootCheck</strong>」、「<strong data-svelte-h="svelte-7cunve">BypassCPUCheck</strong>」及「<strong data-svelte-h="svelte-1k34trc">BypassRAMCheck</strong>」，並將值全部設定為 1
<img src="https://hackmd.io/_uploads/H1wN_tOhn.png" alt="https://hackmd.io/_uploads/H1wN_tOhn.png" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/HkbSOFd32.png" alt="https://hackmd.io/_uploads/HkbSOFd32.png" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/SyLSOt_h2.png" alt="https://hackmd.io/_uploads/SyLSOt_h2.png" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/rJgjotu2n.png" alt="https://hackmd.io/_uploads/rJgjotu2n.png" class="rounded-lg my-2" loading="lazy" decoding="async">
最後回上一步再進入安裝介面，即成功進入安裝介面
<img src="https://hackmd.io/_uploads/BJ813FOn2.png" alt="https://hackmd.io/_uploads/BJ813FOn2.png" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h2 id="organizational-unit-ou" data-svelte-h="svelte-q8cz0z"><a href="#organizational-unit-ou">Organizational Unit (OU)</a></h2> <h3 id="新增" data-svelte-h="svelte-hyguy8"><a href="#新增">新增</a></h3> <p>到 Active Directory Users and Computers -&gt; New -&gt; Organizational Unit
<img src="https://hackmd.io/_uploads/SkxfW-zTp.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h3 id="刪除" data-svelte-h="svelte-16gpp74"><a href="#刪除">刪除</a></h3> <p>直接將 OU 刪除的話，會遇到這個錯誤：
<img src="https://hackmd.io/_uploads/ryr1XZf6p.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
若要刪除 OU 需先設定：
Step 1. 將目標網域右鍵 -&gt; View -&gt; 點選 Advanced Features
<img src="https://hackmd.io/_uploads/BkzAzbM6a.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
Step 2. 到想要刪除的 OU 右鍵 -&gt; Properties -&gt; Object -&gt; 將 Project object from accidental deletion 取消勾選 -&gt; OK
<img src="https://hackmd.io/_uploads/r1IKmWzaT.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/BkxgubGTp.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
刪除時就不會出現錯誤了</p> <h2 id="當-iis-有使用到網路資源的設定" data-svelte-h="svelte-1czxb0u"><a href="#當-iis-有使用到網路資源的設定">當 IIS 有使用到網路資源的設定</a></h2> <p>不要使用掛載後的硬碟路徑，直接使用其網路路徑
<img src="https://hackmd.io/_uploads/B1Wh72pap.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/r1uPE2aTT.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h2 id="edge-group-policy-templates-admx-54-分區可能出" data-svelte-h="svelte-7oo0vn"><a href="#edge-group-policy-templates-admx-54-分區可能出">Edge Group Policy Templates ADMX (54 分區可能出)</a></h2> <h3 id="安裝" data-svelte-h="svelte-1mwadu8"><a href="#安裝">安裝</a></h3> <p>打開 <code data-svelte-h="svelte-suufxd">MicrosoftEdgePolicyTemplates\windows\admx</code>
將這三個檔案複製到 <code data-svelte-h="svelte-tcc0k4">C:\Windows\PolicyDefinitions</code> <img src="https://hackmd.io/_uploads/B1csbpDCp.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/Skawzaw0p.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
再回到 admx 資料夾，選擇當下系統的語系
(若英文就是 en-US，中文就是 zh-TW，這裡的系統是 en-US)
複製裡面全部的檔案到 <code data-svelte-h="svelte-mtg0qu">C:\Windows\PolicyDefinitions\en-US</code> <img src="https://hackmd.io/_uploads/r1Jd7TPA6.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h3 id="套用更新" data-svelte-h="svelte-1kh5iod"><a href="#套用更新">套用更新</a></h3> <p>執行指令 <code data-svelte-h="svelte-1fy3f7c">gpupdate /force</code>，再開啟 <code data-svelte-h="svelte-hhbks">gpedit.msc</code> 或 Group Policy Management，在 Computer Configuration -&gt; Administrative Templates 下即可看到四個新的與 Edge 相關的 Policy 設定
<img src="https://hackmd.io/_uploads/BkqvHaPCp.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/rkxxC0DAp.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
註：若 Client 端未安裝 ADMX 也可以套用規則</p> <h3 id="封鎖衝浪遊戲-surf-game" data-svelte-h="svelte-og2ker"><a href="#封鎖衝浪遊戲-surf-game">封鎖衝浪遊戲 (Surf Game)</a></h3> <ul><li>Setting
<img src="https://hackmd.io/_uploads/B1V1cL_Ra.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></li> <li>Effect
<img src="https://hackmd.io/_uploads/Hy1cq8_CT.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></li></ul> <h3 id="啟動首頁和新索引標籤頁面-startup-home-page-and-new-tab-page" data-svelte-h="svelte-g9wrhy"><a href="#啟動首頁和新索引標籤頁面-startup-home-page-and-new-tab-page">啟動、首頁和新索引標籤頁面 (Startup, home page and new tab page)</a></h3> <ul><li>EN
<img src="https://hackmd.io/_uploads/Bk-TBU_AT.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></li> <li>ZH_TW
<img src="https://hackmd.io/_uploads/HkihDUOCa.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></li></ul> <h3 id="允許或拒絕網頁截取螢幕畫面-allow-or-deny-screen-capture" data-svelte-h="svelte-1qtyf9r"><a href="#允許或拒絕網頁截取螢幕畫面-allow-or-deny-screen-capture">允許或拒絕網頁截取螢幕畫面 (Allow or deny screen capture)</a></h3> <p><img src="https://hackmd.io/_uploads/HymET8dRa.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h3 id="拒絕存取特定網站-block-access-to-a-list-of-urls" data-svelte-h="svelte-tlhvv4"><a href="#拒絕存取特定網站-block-access-to-a-list-of-urls">拒絕存取特定網站 (Block access to a list of URLs)</a></h3> <ul><li>Setting
<img src="https://hackmd.io/_uploads/BkfMyvuAa.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/SJ1VyPdAT.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></li> <li>Effect
<img src="https://hackmd.io/_uploads/rk8U1w_Ca.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></li></ul> <h2 id="對單個使用者或群組做密碼限制-ad-ac" data-svelte-h="svelte-1s5aqjk"><a href="#對單個使用者或群組做密碼限制-ad-ac">對單個使用者或群組做密碼限制 (AD AC)</a></h2> <p>打開 AD AC，到 domain (local) -&gt; System -&gt; Password Settings Container -&gt; 右鍵 Password Settings
<img src="https://hackmd.io/_uploads/BJLgKWKCp.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">創立一個至少需要輸入 8 個字的密碼規則</span></div></code></div></pre><!-- HTML_TAG_END --> <p><img src="https://hackmd.io/_uploads/H1YC5bFCp.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
回到 Users -&gt; 選擇自己要套用設定的使用者或群組 -&gt; 右鍵 Properties -&gt; Password Settings -&gt; Assign…
<img src="https://hackmd.io/_uploads/Hy1D2-YAp.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
選 Advenced…
<img src="https://hackmd.io/_uploads/BkfepWtAa.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
選 Find Now -&gt; 選擇自己建立的規則
<img src="https://hackmd.io/_uploads/B1ZXTZKCp.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
若新輸入的密碼不到 8 個字：
<img src="https://hackmd.io/_uploads/SJFSAZtC6.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/rkKDRWtAT.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
若有至少 8 個字：
<img src="https://hackmd.io/_uploads/HkeiRbt0p.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/B1kp0-YRa.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h2 id="遠端桌面服務-remote-desktop-service" data-svelte-h="svelte-1oy4yin"><a href="#遠端桌面服務-remote-desktop-service">遠端桌面服務 (Remote Desktop Service)</a></h2> <p>安裝服務：
<img src="https://hackmd.io/_uploads/HJLDgliR6.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/ry_igeiCT.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/ryc6xgjC6.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
使用 Internet Explorer 可瀏覽其 RDWeb (在沒有 SSL 簽證的狀況下)：
<img src="https://hackmd.io/_uploads/SkJB4giRp.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/HktnHxsCp.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
也可透過網域使用者直接遠端 Server：
<img src="https://hackmd.io/_uploads/BJqYNxo0T.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/SJah4gjRp.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
若簽證了可使用 Edge 正常預覽：
<img src="https://hackmd.io/_uploads/HkzMwxsR6.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h2 id="啟用-ip-forwarding-regedit" data-svelte-h="svelte-1y6z8ga"><a href="#啟用-ip-forwarding-regedit">啟用 IP Forwarding (Regedit)</a></h2> <p>按一下 Windows Key + R，輸入 regedit 後 Enter
設定「<strong data-svelte-h="svelte-1y8ohbs">Computer\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\IPEnableRouter</strong>」為 1
<img src="https://hackmd.io/_uploads/SJNNwq0AT.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h2 id="啟用-ntp-server-windows-server" data-svelte-h="svelte-1jha5cb"><a href="#啟用-ntp-server-windows-server">啟用 NTP Server (Windows Server)</a></h2> <p data-svelte-h="svelte-kr75hh">修改登錄檔，以下設定都是在目錄：「<strong>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W32Time</strong>」做設定，故只補充其後段的位置</p> <ul data-svelte-h="svelte-prcz8d"><li>設定為 NTP Server：<strong>「\Parameters\Type」</strong> 更改為 “NTP”</li> <li>啟動 NTP Server：「<strong>\TimeProviders\NtpServer\Enabled</strong>」 更改為 “1”</li> <li>設定時間修正：「<strong>\Config\MaxPosPhaseCorrection</strong> 和 <strong>\Config\MaxNegPhaseCorrection</strong>」更改數值為 “1800” (十進位)
用 cmd 重啟 Windows Time Service</li></ul> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="="><div class='code-container'><code>開啟 cmd.exe
net stop w32time (停止 Service)
net start w32time (啟用 Service)</code></div></pre><!-- Note from shiki-twoslash: the language bash== was not set up for Shiki to use, and so there is no code highlighting --><!-- HTML_TAG_END --> <h2 id="次級憑證的簽證及安裝-sub-ca" data-svelte-h="svelte-wp48zq"><a href="#次級憑證的簽證及安裝-sub-ca">次級憑證的簽證及安裝 (Sub CA)</a></h2> <p>先到已安裝 Main CA 的 Server，打開 Certification Authority -&gt; 點選 Server 後右鍵 Properties
<img src="https://hackmd.io/_uploads/Sk4pHiuX0.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
點選 Extensions -&gt; Select extension 選擇 CDP -&gt; 點選 http 開頭的項目 -&gt; 勾選第三跟第四個選項
<img src="https://hackmd.io/_uploads/SJFFvsdXR.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
Select extension 換選擇 AIA -&gt; 點選 http 開頭的項目 -&gt; 勾選第一個選項 -&gt; 點擊 Apply
<img src="https://hackmd.io/_uploads/ByfCDiOQA.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <p>接著轉到需要安裝 Sub CA 的 Server，打開 Certification Authority -&gt; 點選 Server 後右鍵 All Tasks -&gt; Renew CA Certificate…
<img src="https://hackmd.io/_uploads/rJWrKiumR.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
確認 Computer Name 跟 Parent CA 都正確後，點擊 OK
<img src="https://hackmd.io/_uploads/rylCtidQR.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <p>回到 Main CA Server -&gt; Pending Requests -&gt; Issue 從 Sub CA 發起的請求
<img src="https://hackmd.io/_uploads/SyRN5i_mR.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
Issued Certidicates -&gt; 選擇剛剛 Issue 的 CA -&gt; Details -&gt; Copy to File…
<img src="https://hackmd.io/_uploads/Sydp9s_QR.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
選擇 DER encoded 的 X.509 -&gt; Next -&gt; 儲存於自己指定的位置 -&gt; 複製到 Sub CA Server
<img src="https://hackmd.io/_uploads/rJfVojOQC.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <p>再回到 Sub CA Server，點選 Server 後右鍵 All Tasks -&gt; Install CA Certificate…
<img src="https://hackmd.io/_uploads/HyXAijdm0.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
右下角選擇 X.509 類型的 CA -&gt; 選擇剛剛簽好的 CA
<img src="https://hackmd.io/_uploads/ByrOnjOXR.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
安裝好後，Sub CA Server 圖標會有綠色勾勾，代表正常運作</p> <h3 id="error-the-revocation-function-was-unable-to-check-revocation-because-the-revocation-server-was-offline" data-svelte-h="svelte-1k9tv90"><a href="#error-the-revocation-function-was-unable-to-check-revocation-because-the-revocation-server-was-offline">error: The revocation function was unable to check revocation because the revocation server was offline</a></h3> <p><img src="https://learn-attachment.microsoft.com/api/attachments/7a610d77-a91c-4fdd-b852-8997ea966c54?platform=QnA" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
此錯誤為無法從 Root CA 的 CRL 發布點下載撤銷憑證名單，可先嘗試透過在 hosts 內增加對 Root CA Server 的記錄 (可能需要執行 <code data-svelte-h="svelte-14xu26v">ipconfig /flushdns</code> 保證系統會透過 hosts 內的記錄找尋)
<img src="https://hackmd.io/_uploads/By5GaH-rR.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <p data-svelte-h="svelte-vx6mvu">若錯誤還在，也可透過 PowerShell 指令直接停用 CRL 檢查及下載</p> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="="><div class='code-container'><code>certutil -setreg caCRLFlags +CRLF_REVCHECK_IGNORE_OFFLINE</code></div></pre><!-- Note from shiki-twoslash: the language bash== was not set up for Shiki to use, and so there is no code highlighting --><!-- HTML_TAG_END --> <h2 id="透過-powershell-建立-raid" data-svelte-h="svelte-63oksh"><a href="#透過-powershell-建立-raid">透過 PowerShell 建立 RAID</a></h2> <h3 id="建立-storage-pool" data-svelte-h="svelte-1440nko"><a href="#建立-storage-pool">建立 Storage Pool</a></h3> <p>打開 Server Manager -&gt; File and Storage Services -&gt; Storage Pools -&gt; 右鍵 -&gt; New Storage Pool…
<img src="https://hackmd.io/_uploads/ryntCEjXC.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h3 id="建立-raid-磁區" data-svelte-h="svelte-1uwjf7o"><a href="#建立-raid-磁區">建立 RAID 磁區</a></h3> <p><img src="https://hackmd.io/_uploads/H14eRVjXA.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="="><div class='code-container'><code>// 假設已建立好 Storage Pool "SRVDisk" (上圖)
// 新增三個磁碟，將其設為其中一個磁碟損壞後仍可持續運作的模式，並以 40GB 左右的空間提供於 E:/
PowerShell 指令：
New-VirtualDisk -StoragePoolFriendlyName SRVDisk -FriendlyName SRVDisk -Size 40GB -ResiliencySettingName "Parity"</code></div></pre><!-- Note from shiki-twoslash: the language bash== was not set up for Shiki to use, and so there is no code highlighting --><!-- HTML_TAG_END --> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">ResiliencySettingName 參數解釋：</span></div><div class='line'><span style="color: undefined">Simple：依建立的磁碟大小，就佔多大的空間，相當於RAID 0</span></div><div class='line'><span style="color: undefined">Mirror：同時寫入多份，增加資料的可用性但減少空間，相當於RAID 1</span></div><div class='line'><span style="color: undefined">Parity：利用位元檢查將資料儲存至各個磁碟上，至少需要三顆以上的磁碟，就算有其中一顆硬碟故障也可正常運作，相當於RAID 5</span></div></code></div></pre><!-- HTML_TAG_END --> <p>找到 Disk Management
<img src="https://hackmd.io/_uploads/Bk_3kBjQ0.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
對剛建立的虛擬硬碟右鍵選擇 Online -&gt; Initialize Disk
<img src="https://hackmd.io/_uploads/HkjubHj70.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"><img src="https://hackmd.io/_uploads/S1vxMrsm0.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
選擇 GPT 分區
<img src="https://hackmd.io/_uploads/B1Wx7SjmR.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
選擇磁區右鍵選擇 New Simple Volume…
<img src="https://hackmd.io/_uploads/rJe8QriQR.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
建立完成
<img src="https://hackmd.io/_uploads/r1H2mSi70.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"> <img src="https://hackmd.io/_uploads/B1lRQHiXC.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h2 id="啟用重複資料刪除機制" data-svelte-h="svelte-1pc4ego"><a href="#啟用重複資料刪除機制">啟用重複資料刪除機制</a></h2> <p>安裝 Data Deduplication
<img src="https://hackmd.io/_uploads/By1ZBcbBR.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
File and Storage Services -&gt; Volumes -&gt; 選中要設定的磁區 -&gt; Configure Data Deduplication
<img src="https://hackmd.io/_uploads/ry5xLqZr0.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
選擇 General purpose file server
<img src="https://hackmd.io/_uploads/Sy92U5-HA.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async">
再按 OK 就完成了</p> <h2 id="ad-users-csv-import--export" data-svelte-h="svelte-1qrgot5"><a href="#ad-users-csv-import--export">AD Users CSV Import / Export</a></h2> <h3 id="csvde-import-無法使用" data-svelte-h="svelte-1lnex7b"><a href="#csvde-import-無法使用">csvde (Import 無法使用？)</a></h3> <p data-svelte-h="svelte-lnkgxb">Import</p> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="="><div class='code-container'><code>csvde -i -k -f [csv_file_path]</code></div></pre><!-- Note from shiki-twoslash: the language bash== was not set up for Shiki to use, and so there is no code highlighting --><!-- HTML_TAG_END --> <p data-svelte-h="svelte-ld6jlm">Export</p> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="="><div class='code-container'><code>csvde -r "(objectClass=user)" -m -f [csv_file_path_for_export]</code></div></pre><!-- Note from shiki-twoslash: the language bash== was not set up for Shiki to use, and so there is no code highlighting --><!-- HTML_TAG_END --> <p><img src="https://hackmd.io/_uploads/HyItOk1dC.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p> <h3 id="powershell-import-users" data-svelte-h="svelte-1bng4yu"><a href="#powershell-import-users">Powershell Import Users</a></h3> <p data-svelte-h="svelte-11yjwvz">使用 <code>Import-CSV</code> 和 <code>ForEach-Object</code> 完成</p> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="="><div class='code-container'><code>Import-Csv -Path [csv_path] | ForEach-Object &#123; 
	$user = $_
	net group $user.group /add
	net user $user.name $user.pass /add
	net group $user.group $user.name /add
&#125;</code></div></pre><!-- Note from shiki-twoslash: the language bash== was not set up for Shiki to use, and so there is no code highlighting --><!-- HTML_TAG_END --> <p><img src="https://hackmd.io/_uploads/BJ2Tdz4_0.png" alt="image" class="rounded-lg my-2" loading="lazy" decoding="async"></p></main> <div class="divider mt-4 mb-0"></div> <div><a href="/?tags=Windows" class="btn btn-sm btn-ghost normal-case mt-2 mr-2 p-category">#Windows </a><a href="/?tags=OS" class="btn btn-sm btn-ghost normal-case mt-2 mr-2 p-category">#OS </a></div></div>  </article> <footer id="footer" class="footer footer-center bg-base-300 text-base-content shadow-inner p-8 md:rounded-box sticky bottom-0 z-0 md:static "><div class="prose"><p><a href="/atom.xml" rel="noopener noreferrer external" target="_blank">Feed</a> <span class="mr-1" data-svelte-h="svelte-1qx196n">·</span><a href="/sitemap.xml" rel="noopener noreferrer external" target="_blank">Sitemap</a> <span class="mr-1" data-svelte-h="svelte-1qx196n">·</span><a href="mailto:kkai1009@gmail.com" rel="noopener noreferrer external" target="_blank">kkai1009@gmail.com</a>  <br>
      Copyright © 2024 Shellkai Huang <br>
      Powered by
      <a rel="noopener noreferrer external" target="_blank" class="tooltip tooltip-secondary hover:text-secondary" data-tip="🌸 [δ] - Based on MDsveX & SvelteKit 🌸" href="https://github.com/importantimport/urara" data-svelte-h="svelte-urea7w">Urara</a> </p></div></footer></div></div></div> 
			<script type="application/json" data-sveltekit-fetched data-url="/posts.json">{"status":200,"statusText":"","headers":{},"body":"[{\"title\":\"Web\",\"summary\":\"Self-Signed Certificate + OpenSSL + ADCS + Nginx & Apache2\",\"image\":\"/badssl.png\",\"alt\":\"Shellkai Huang\",\"created\":\"2024-09-16T00:00:00.000Z\",\"updated\":\"2024-09-16T00:00:00.000Z\",\"tags\":[\"Web\",\"SSL\",\"OS\",\"Nginx\",\"Apache2\"],\"images\":[],\"slug\":\"/certificate-ca-server/+page.svelte.md\",\"path\":\"/certificate-ca-server\",\"toc\":[{\"depth\":2,\"slug\":\"windows-server-簽署-enterprise-ca\",\"title\":\"Windows Server 簽署 (Enterprise CA)\"},{\"depth\":2,\"slug\":\"debian-簽證使用-windows-server\",\"title\":\"Debian (簽證使用 Windows Server)\"},{\"depth\":2,\"slug\":\"預設-html-網頁設定\",\"title\":\"預設 html 網頁設定\"},{\"depth\":2,\"slug\":\"web-server-apache2\",\"title\":\"Web Server (apache2)\"},{\"depth\":3,\"slug\":\"啟用-https-ssl\",\"title\":\"啟用 https (SSL)\"},{\"depth\":3,\"slug\":\"網址重新導向\",\"title\":\"網址重新導向\"},{\"depth\":3,\"slug\":\"站台登入驗證\",\"title\":\"站台登入驗證\"},{\"depth\":3,\"slug\":\"使用者個人網頁模組-userdir\",\"title\":\"使用者個人網頁模組 (userdir)\"},{\"depth\":3,\"slug\":\"更換-port\",\"title\":\"更換 Port\"},{\"depth\":3,\"slug\":\"更換站台\",\"title\":\"更換站台\"},{\"depth\":3,\"slug\":\"預設檔案\",\"title\":\"預設檔案\"},{\"depth\":3,\"slug\":\"403-forbidden-解決\",\"title\":\"403 Forbidden 解決\"},{\"depth\":2,\"slug\":\"web-server-nginx\",\"title\":\"Web Server (Nginx)\"},{\"depth\":3,\"slug\":\"nginxconf-檢查\",\"title\":\"nginx.conf 檢查\"},{\"depth\":3,\"slug\":\"限制-ip-存取站台\",\"title\":\"限制 IP 存取站台\"},{\"depth\":3,\"slug\":\"站台登入驗證-1\",\"title\":\"站台登入驗證\"},{\"depth\":3,\"slug\":\"啟用-https-ssl-1\",\"title\":\"啟用 https (SSL)\"},{\"depth\":3,\"slug\":\"網址重新導向-1\",\"title\":\"網址重新導向\"},{\"depth\":3,\"slug\":\"http-to-https-重新導向\",\"title\":\"http to https 重新導向\"},{\"depth\":3,\"slug\":\"負載平衡分流-load-balance\",\"title\":\"負載平衡/分流 (Load Balance)\"},{\"depth\":3,\"slug\":\"更換站台-1\",\"title\":\"更換站台\"},{\"depth\":3,\"slug\":\"location-匹配選擇機制\",\"title\":\"location (匹配選擇機制)\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Debian\",\"image\":\"/debian.jpg\",\"alt\":\"Shellkai Huang\",\"created\":\"2024-09-16T00:00:00.000Z\",\"updated\":\"2024-09-16T00:00:00.000Z\",\"tags\":[\"Linux\",\"OS\"],\"images\":[],\"slug\":\"/debian/+page.svelte.md\",\"path\":\"/debian\",\"toc\":[{\"depth\":2,\"slug\":\"安裝功能\",\"title\":\"安裝功能\"},{\"depth\":2,\"slug\":\"vim\",\"title\":\"vim\"},{\"depth\":3,\"slug\":\"在-putty-上直接對-vim-貼上資料\",\"title\":\"在 putty 上直接對 vim 貼上資料\"},{\"depth\":2,\"slug\":\"開啟新-console\",\"title\":\"開啟新 Console\"},{\"depth\":2,\"slug\":\"刪除相關指令\",\"title\":\"刪除相關指令\"},{\"depth\":3,\"slug\":\"檔案相關\",\"title\":\"檔案相關\"},{\"depth\":3,\"slug\":\"完整刪除套件-apt\",\"title\":\"完整刪除套件 (apt)\"},{\"depth\":2,\"slug\":\"hostname-更改\",\"title\":\"hostname 更改\"},{\"depth\":2,\"slug\":\"samba-資料夾共享\",\"title\":\"Samba (資料夾共享)\"},{\"depth\":3,\"slug\":\"samba-存取驗證-smbpasswd\",\"title\":\"Samba 存取驗證 (smbpasswd)\"},{\"depth\":2,\"slug\":\"chmod-權限修改\",\"title\":\"chmod (權限修改)\"},{\"depth\":3,\"slug\":\"數字代表的權限\",\"title\":\"數字代表的權限\"},{\"depth\":3,\"slug\":\"資料夾權限更改\",\"title\":\"資料夾權限更改\"},{\"depth\":3,\"slug\":\"資料夾及內部檔案權限更改\",\"title\":\"資料夾及內部檔案權限更改\"},{\"depth\":2,\"slug\":\"修改-ip-位置\",\"title\":\"修改 IP 位置\"},{\"depth\":3,\"slug\":\"error-rtnetlink-answers-file-exists\",\"title\":\"error: RTNETLINK answers: File exists\"},{\"depth\":2,\"slug\":\"自訂網卡名稱-attr\",\"title\":\"自訂網卡名稱 (ATTR)\"},{\"depth\":2,\"slug\":\"關閉最後登入訊息顯示\",\"title\":\"關閉最後登入訊息顯示\"},{\"depth\":2,\"slug\":\"ufw-firewall-useless\",\"title\":\"ufw (Firewall) (useless)\"},{\"depth\":2,\"slug\":\"iptables\",\"title\":\"iptables\"},{\"depth\":3,\"slug\":\"基本設定\",\"title\":\"基本設定\"},{\"depth\":3,\"slug\":\"port-連線管理\",\"title\":\"Port 連線管理\"},{\"depth\":3,\"slug\":\"nat-轉址服務\",\"title\":\"NAT 轉址服務\"},{\"depth\":4,\"slug\":\"snat-原位址轉換-內傳外\",\"title\":\"SNAT (原位址轉換) (內傳外)\"},{\"depth\":4,\"slug\":\"dnat-目的位址轉換-外傳內\",\"title\":\"DNAT (目的位址轉換) (外傳內)\"},{\"depth\":3,\"slug\":\"port-forwarding\",\"title\":\"Port Forwarding\"},{\"depth\":3,\"slug\":\"啟用-ipv4-封包轉發\",\"title\":\"啟用 IPv4 封包轉發\"},{\"depth\":3,\"slug\":\"icmp-封包管理-ip-a-連線到-ip-b-限制\",\"title\":\"ICMP 封包管理 (IP A 連線到 IP B 限制)\"},{\"depth\":3,\"slug\":\"保存當前設定-全部規則皆適用\",\"title\":\"保存當前設定 (全部規則皆適用)\"},{\"depth\":3,\"slug\":\"刪除某一行規則\",\"title\":\"刪除某一行規則\"},{\"depth\":2,\"slug\":\"dns-server-bind9\",\"title\":\"DNS Server (Bind9)\"},{\"depth\":3,\"slug\":\"正解建立\",\"title\":\"正解建立\"},{\"depth\":3,\"slug\":\"反解建立\",\"title\":\"反解建立\"},{\"depth\":3,\"slug\":\"dns-授權\",\"title\":\"DNS 授權\"},{\"depth\":3,\"slug\":\"請求轉送\",\"title\":\"請求轉送\"},{\"depth\":3,\"slug\":\"建立大量有順序紀錄\",\"title\":\"建立大量有順序紀錄\"},{\"depth\":3,\"slug\":\"編輯版本號碼-有版本詢問時回傳特定文字\",\"title\":\"編輯版本號碼 (有版本詢問時，回傳特定文字)\"},{\"depth\":3,\"slug\":\"mx-紀錄建立\",\"title\":\"MX 紀錄建立\"},{\"depth\":2,\"slug\":\"web-file-server\",\"title\":\"Web File Server\"},{\"depth\":3,\"slug\":\"return-code-13-read-only\",\"title\":\"Return Code 13 (Read-Only)\"},{\"depth\":2,\"slug\":\"查看目前目錄下檔案及目錄之權限\",\"title\":\"查看目前目錄下檔案及目錄之權限\"},{\"depth\":2,\"slug\":\"批量加入使用者-for-loop\",\"title\":\"批量加入使用者 (for loop)\"},{\"depth\":2,\"slug\":\"使用者和群組常用設定指令\",\"title\":\"使用者和群組常用設定指令\"},{\"depth\":2,\"slug\":\"密碼常用指令\",\"title\":\"密碼常用指令\"},{\"depth\":2,\"slug\":\"dhcp-server\",\"title\":\"DHCP Server\"},{\"depth\":3,\"slug\":\"檢查-dhcp-server-已發出去的-ip-位址\",\"title\":\"檢查 DHCP Server 已發出去的 IP 位址\"},{\"depth\":3,\"slug\":\"設定跨網段-dhcp-server\",\"title\":\"設定跨網段 DHCP Server\"},{\"depth\":3,\"slug\":\"dhcp-relay\",\"title\":\"DHCP Relay\"},{\"depth\":2,\"slug\":\"在-root-使用-rmcp-及-mv-指令前先確認是否要執行\",\"title\":\"在 root 使用 rm，cp 及 mv 指令前先確認是否要執行\"},{\"depth\":2,\"slug\":\"sudo-設定\",\"title\":\"sudo 設定\"},{\"depth\":3,\"slug\":\"設定某些使用者或群組不需密碼即可使用-sudo\",\"title\":\"設定某些使用者或群組不需密碼即可使用 sudo\"},{\"depth\":3,\"slug\":\"限制-sudo-使用者可使用的指令\",\"title\":\"限制 sudo 使用者可使用的指令\"},{\"depth\":2,\"slug\":\"log-查看-以-vim-開啟\",\"title\":\"log 查看 (以 vim 開啟)\"},{\"depth\":2,\"slug\":\"ifconfig\",\"title\":\"ifconfig\"},{\"depth\":2,\"slug\":\"硬碟設定\",\"title\":\"硬碟設定\"},{\"depth\":3,\"slug\":\"掛載\",\"title\":\"掛載\"},{\"depth\":2,\"slug\":\"sed-stream-editor\",\"title\":\"sed (Stream Editor)\"},{\"depth\":2,\"slug\":\"echo-html\",\"title\":\"echo html\"},{\"depth\":2,\"slug\":\"chrony-ntp-client\",\"title\":\"chrony (NTP Client)\"},{\"depth\":2,\"slug\":\"ftp-server-vsftpd\",\"title\":\"FTP Server (vsftpd)\"},{\"depth\":3,\"slug\":\"使用-ipv4\",\"title\":\"使用 IPv4\"},{\"depth\":3,\"slug\":\"允許-root-登入\",\"title\":\"允許 Root 登入\"},{\"depth\":3,\"slug\":\"參數解釋\",\"title\":\"參數解釋\"},{\"depth\":3,\"slug\":\"ssl\",\"title\":\"SSL\"},{\"depth\":2,\"slug\":\"靜態路由-ip-route\",\"title\":\"靜態路由 (ip route)\"},{\"depth\":3,\"slug\":\"重啟後保留靜態路由設定\",\"title\":\"重啟後保留靜態路由設定\"},{\"depth\":2,\"slug\":\"playbook-ansible\",\"title\":\"PlayBook (Ansible)\"},{\"depth\":3,\"slug\":\"bash-commends-on-playbook\",\"title\":\"Bash commends on PlayBook\"},{\"depth\":4,\"slug\":\"method-1-command\",\"title\":\"Method 1 (command)\"},{\"depth\":4,\"slug\":\"method-2\",\"title\":\"Method 2\"},{\"depth\":3,\"slug\":\"file-檔案資料夾處理\",\"title\":\"file (檔案、資料夾處理)\"},{\"depth\":3,\"slug\":\"lineinfile-編輯檔案內文字\",\"title\":\"lineinfile (編輯檔案內文字)\"},{\"depth\":3,\"slug\":\"blockinfile\",\"title\":\"blockinfile\"},{\"depth\":3,\"slug\":\"replace-全局替換\",\"title\":\"replace (全局替換)\"},{\"depth\":3,\"slug\":\"copy-複製檔案\",\"title\":\"copy (複製檔案)\"},{\"depth\":3,\"slug\":\"apt-安裝-apt-套件\",\"title\":\"apt (安裝 apt 套件)\"},{\"depth\":4,\"slug\":\"單套件\",\"title\":\"單套件\"},{\"depth\":4,\"slug\":\"多套件\",\"title\":\"多套件\"},{\"depth\":3,\"slug\":\"stat-檢查檔案或路徑是否存在\",\"title\":\"stat (檢查檔案或路徑是否存在)\"},{\"depth\":3,\"slug\":\"read_csv-讀取-csv-檔案\",\"title\":\"read_csv (讀取 CSV 檔案)\"},{\"depth\":3,\"slug\":\"user-使用者建立及管理\",\"title\":\"user (使用者建立及管理)\"},{\"depth\":4,\"slug\":\"loop\",\"title\":\"loop\"},{\"depth\":3,\"slug\":\"read_csv--user-以-csv-檔案匯入-users\",\"title\":\"read_csv + user (以 CSV 檔案匯入 Users)\"},{\"depth\":3,\"slug\":\"debug--msg-print-out-輸出文字\",\"title\":\"debug + msg (print out) (輸出文字)\"},{\"depth\":3,\"slug\":\"vars_prompt-輸入值\",\"title\":\"vars_prompt (輸入值)\"},{\"depth\":2,\"slug\":\"easy-rsa-ca-tool\",\"title\":\"Easy-RSA (CA Tool)\"},{\"depth\":3,\"slug\":\"自簽-root-ca\",\"title\":\"自簽 Root CA\"},{\"depth\":3,\"slug\":\"簽署旗下的-request\",\"title\":\"簽署旗下的 Request\"},{\"depth\":2,\"slug\":\"openconnect-ssl-vpn-server-ocserv\",\"title\":\"OpenConnect SSL VPN Server (ocserv)\"},{\"depth\":2,\"slug\":\"debian-加入-windows-server-ad-網域\",\"title\":\"Debian 加入 Windows Server AD 網域\"},{\"depth\":3,\"slug\":\"不使用完整網域使用者名稱並允許使用者登入\",\"title\":\"不使用完整網域使用者名稱並允許使用者登入\"},{\"depth\":2,\"slug\":\"解壓縮-targz\",\"title\":\"解壓縮 tar.gz\"},{\"depth\":2,\"slug\":\"vlan-子介面\",\"title\":\"VLAN 子介面\"},{\"depth\":3,\"slug\":\"跨-vlan-使用-dhcp-server--dhcp-relay\",\"title\":\"跨 VLAN 使用 DHCP Server + DHCP Relay\"},{\"depth\":2,\"slug\":\"設定介面啟用或關閉時的行為\",\"title\":\"設定介面啟用或關閉時的行為\"},{\"depth\":2,\"slug\":\"strongswan-ipsec--ikev1v2\",\"title\":\"StrongSwan (IPSec & IKEv1、v2)\"},{\"depth\":3,\"slug\":\"建立用於-ipsec-的-tunnel\",\"title\":\"建立用於 IPSec 的 Tunnel\"},{\"depth\":2,\"slug\":\"frrouting-frr\",\"title\":\"FRRouting (FRR)\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Windows Server\",\"image\":\"/winsrv.jpg\",\"alt\":\"Shellkai Huang\",\"created\":\"2024-09-16T00:00:00.000Z\",\"updated\":\"2024-09-16T00:00:00.000Z\",\"tags\":[\"Windows\",\"OS\"],\"images\":[],\"slug\":\"/winsrv/+page.svelte.md\",\"path\":\"/winsrv\",\"toc\":[{\"depth\":2,\"slug\":\"gpo-相關設定\",\"title\":\"GPO 相關設定\"},{\"depth\":3,\"slug\":\"初次登錄動畫關閉\",\"title\":\"初次登錄動畫關閉\"},{\"depth\":3,\"slug\":\"禁止存取控制台設定\",\"title\":\"禁止存取控制台設定\"},{\"depth\":3,\"slug\":\"限制或禁止使用者使用特定應用程式\",\"title\":\"限制或禁止使用者使用特定應用程式\"},{\"depth\":3,\"slug\":\"設定在-logon-ui-看不到上個登入的使用者\",\"title\":\"設定在 Logon UI 看不到上個登入的使用者\"},{\"depth\":3,\"slug\":\"登入時自動掛載共享資料夾\",\"title\":\"登入時自動掛載共享資料夾\"},{\"depth\":3,\"slug\":\"若共享資料夾有跨網域\",\"title\":\"若共享資料夾有跨網域\"},{\"depth\":3,\"slug\":\"讓-windows-server-也能掛載-debian-smbd\",\"title\":\"讓 Windows Server 也能掛載 Debian SMBD\"},{\"depth\":3,\"slug\":\"gpo-個別使用者套用規則\",\"title\":\"GPO 個別使用者套用規則\"},{\"depth\":3,\"slug\":\"開機時自動跳出訊息\",\"title\":\"開機時自動跳出訊息\"},{\"depth\":3,\"slug\":\"禁止使用-windows-update\",\"title\":\"禁止使用 Windows Update\"},{\"depth\":3,\"slug\":\"登入時自動將檔案複製到桌面\",\"title\":\"登入時自動將檔案複製到桌面\"},{\"depth\":3,\"slug\":\"用指令載入登錄檔\",\"title\":\"用指令載入登錄檔\"},{\"depth\":2,\"slug\":\"dns\",\"title\":\"DNS\"},{\"depth\":3,\"slug\":\"dns-快取紀錄關閉\",\"title\":\"DNS 快取紀錄關閉\"},{\"depth\":3,\"slug\":\"dns-同步\",\"title\":\"DNS 同步\"},{\"depth\":4,\"slug\":\"通知-notify\",\"title\":\"通知 (Notify)\"},{\"depth\":4,\"slug\":\"start-of-authority-record-soa\",\"title\":\"Start of Authority Record (SOA)\"},{\"depth\":3,\"slug\":\"conditional-forwarders\",\"title\":\"Conditional Forwarders\"},{\"depth\":2,\"slug\":\"使用者設定-cmd--for-loop\",\"title\":\"使用者設定 (cmd & for loop)\"},{\"depth\":2,\"slug\":\"進階使用者設定-powershell--for-loop\",\"title\":\"進階使用者設定 (PowerShell & for loop)\"},{\"depth\":3,\"slug\":\"set-aduser\",\"title\":\"Set-ADUser\"},{\"depth\":3,\"slug\":\"dsmod\",\"title\":\"dsmod\"},{\"depth\":2,\"slug\":\"群組設定-cmd--for-loop\",\"title\":\"群組設定 (cmd & for loop)\"},{\"depth\":3,\"slug\":\"一次允許多個可使用遠端桌面的使用者\",\"title\":\"一次允許多個可使用遠端桌面的使用者\"},{\"depth\":2,\"slug\":\"允許-icmp-協議\",\"title\":\"允許 ICMP 協議\"},{\"depth\":2,\"slug\":\"讓網域內電腦自動信任-ca-憑證\",\"title\":\"讓網域內電腦自動信任 CA 憑證\"},{\"depth\":3,\"slug\":\"允許自動信任設定\",\"title\":\"允許自動信任設定\"},{\"depth\":3,\"slug\":\"設定自動信任的電腦\",\"title\":\"設定自動信任的電腦\"},{\"depth\":2,\"slug\":\"共享資料夾管理-file-server-resource-manager\",\"title\":\"共享資料夾管理 (File Server Resource Manager)\"},{\"depth\":3,\"slug\":\"限制共享資料夾空間\",\"title\":\"限制共享資料夾空間\"},{\"depth\":3,\"slug\":\"限制共享資料夾存放檔案類型\",\"title\":\"限制共享資料夾存放檔案類型\"},{\"depth\":2,\"slug\":\"快速啟動網路介面控制\",\"title\":\"快速啟動網路介面控制\"},{\"depth\":2,\"slug\":\"更改-remote-desktop-的-tcp-port-登錄檔修改\",\"title\":\"更改 Remote Desktop 的 TCP Port (登錄檔修改)\"},{\"depth\":2,\"slug\":\"dhcp-server-位址保留\",\"title\":\"DHCP Server 位址保留\"},{\"depth\":2,\"slug\":\"vpn-設定\",\"title\":\"VPN 設定\"},{\"depth\":3,\"slug\":\"sstp-設定\",\"title\":\"SSTP 設定\"},{\"depth\":4,\"slug\":\"有-web-server--https\",\"title\":\"有 Web Server + HTTPS\"},{\"depth\":3,\"slug\":\"radius-驗證伺服器\",\"title\":\"RADIUS 驗證伺服器\"},{\"depth\":2,\"slug\":\"讓外部電腦信任根憑證-root-ca\",\"title\":\"讓外部電腦信任根憑證 (Root CA)\"},{\"depth\":2,\"slug\":\"windows-11\",\"title\":\"Windows 11\"},{\"depth\":3,\"slug\":\"安裝跳過-tpmcpu-和-secure-boot-檢查\",\"title\":\"安裝跳過 TPM、CPU 和 Secure Boot 檢查\"},{\"depth\":2,\"slug\":\"organizational-unit-ou\",\"title\":\"Organizational Unit (OU)\"},{\"depth\":3,\"slug\":\"新增\",\"title\":\"新增\"},{\"depth\":3,\"slug\":\"刪除\",\"title\":\"刪除\"},{\"depth\":2,\"slug\":\"當-iis-有使用到網路資源的設定\",\"title\":\"當 IIS 有使用到網路資源的設定\"},{\"depth\":2,\"slug\":\"edge-group-policy-templates-admx-54-分區可能出\",\"title\":\"Edge Group Policy Templates ADMX (54 分區可能出)\"},{\"depth\":3,\"slug\":\"安裝\",\"title\":\"安裝\"},{\"depth\":3,\"slug\":\"套用更新\",\"title\":\"套用更新\"},{\"depth\":3,\"slug\":\"封鎖衝浪遊戲-surf-game\",\"title\":\"封鎖衝浪遊戲 (Surf Game)\"},{\"depth\":3,\"slug\":\"啟動首頁和新索引標籤頁面-startup-home-page-and-new-tab-page\",\"title\":\"啟動、首頁和新索引標籤頁面 (Startup, home page and new tab page)\"},{\"depth\":3,\"slug\":\"允許或拒絕網頁截取螢幕畫面-allow-or-deny-screen-capture\",\"title\":\"允許或拒絕網頁截取螢幕畫面 (Allow or deny screen capture)\"},{\"depth\":3,\"slug\":\"拒絕存取特定網站-block-access-to-a-list-of-urls\",\"title\":\"拒絕存取特定網站 (Block access to a list of URLs)\"},{\"depth\":2,\"slug\":\"對單個使用者或群組做密碼限制-ad-ac\",\"title\":\"對單個使用者或群組做密碼限制 (AD AC)\"},{\"depth\":2,\"slug\":\"遠端桌面服務-remote-desktop-service\",\"title\":\"遠端桌面服務 (Remote Desktop Service)\"},{\"depth\":2,\"slug\":\"啟用-ip-forwarding-regedit\",\"title\":\"啟用 IP Forwarding (Regedit)\"},{\"depth\":2,\"slug\":\"啟用-ntp-server-windows-server\",\"title\":\"啟用 NTP Server (Windows Server)\"},{\"depth\":2,\"slug\":\"次級憑證的簽證及安裝-sub-ca\",\"title\":\"次級憑證的簽證及安裝 (Sub CA)\"},{\"depth\":3,\"slug\":\"error-the-revocation-function-was-unable-to-check-revocation-because-the-revocation-server-was-offline\",\"title\":\"error: The revocation function was unable to check revocation because the revocation server was offline\"},{\"depth\":2,\"slug\":\"透過-powershell-建立-raid\",\"title\":\"透過 PowerShell 建立 RAID\"},{\"depth\":3,\"slug\":\"建立-storage-pool\",\"title\":\"建立 Storage Pool\"},{\"depth\":3,\"slug\":\"建立-raid-磁區\",\"title\":\"建立 RAID 磁區\"},{\"depth\":2,\"slug\":\"啟用重複資料刪除機制\",\"title\":\"啟用重複資料刪除機制\"},{\"depth\":2,\"slug\":\"ad-users-csv-import--export\",\"title\":\"AD Users CSV Import / Export\"},{\"depth\":3,\"slug\":\"csvde-import-無法使用\",\"title\":\"csvde (Import 無法使用？)\"},{\"depth\":3,\"slug\":\"powershell-import-users\",\"title\":\"Powershell Import Users\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"About Me!\",\"image\":\"/hello-world/kita-ikuyo.jpg\",\"alt\":\"Shellkai Huang\",\"created\":\"2024-09-14T00:00:00.000Z\",\"updated\":\"2024-09-14T00:00:00.000Z\",\"images\":[],\"tags\":[],\"slug\":\"/hello-world/about_me/+page.svelte.md\",\"path\":\"/hello-world/about_me\",\"toc\":[{\"depth\":2,\"slug\":\"關於我\",\"title\":\"關於我\"},{\"depth\":2,\"slug\":\"contestant-memories\",\"title\":\"Contestant memories\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"(Blog's Template Document) Elements\",\"created\":\"2021-12-12T00:00:00.000Z\",\"tags\":[\"Document\",\"Elements\"],\"updated\":\"2024-09-21T17:26:03.425Z\",\"images\":[],\"slug\":\"/hello-world/elements/+page.svelte.md\",\"path\":\"/hello-world/elements\",\"toc\":[{\"depth\":2,\"slug\":\"headings\",\"title\":\"Headings\"},{\"depth\":3,\"slug\":\"heading\",\"title\":\"Heading\"},{\"depth\":4,\"slug\":\"heading-1\",\"title\":\"Heading\"},{\"depth\":5,\"slug\":\"heading-2\",\"title\":\"Heading\"},{\"depth\":6,\"slug\":\"heading-3\",\"title\":\"Heading\"},{\"depth\":2,\"slug\":\"paragraphs\",\"title\":\"Paragraphs\"},{\"depth\":2,\"slug\":\"lists\",\"title\":\"Lists\"},{\"depth\":3,\"slug\":\"definition-list-dl\",\"title\":\"Definition List (dl)\"},{\"depth\":3,\"slug\":\"ordered-list-ol\",\"title\":\"Ordered List (ol)\"},{\"depth\":3,\"slug\":\"unordered-list-ul\",\"title\":\"Unordered List (ul)\"},{\"depth\":3,\"slug\":\"checkbox-list-ul\",\"title\":\"Checkbox List (ul)\"},{\"depth\":2,\"slug\":\"table\",\"title\":\"Table\"},{\"depth\":2,\"slug\":\"footnotes\",\"title\":\"Footnotes\"},{\"depth\":2,\"slug\":\"code\",\"title\":\"Code\"},{\"depth\":2,\"slug\":\"misc\",\"title\":\"Misc\"},{\"depth\":2,\"slug\":\"svelte-components\",\"title\":\"Svelte Components\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Hello World\",\"image\":\"/hello-world/ciallo.jpg\",\"created\":\"2021-11-01T00:00:00.000Z\",\"updated\":\"2021-12-12T00:00:00.000Z\",\"tags\":[\"Hello World\"],\"images\":[],\"slug\":\"/hello-world/+page.svelte.md\",\"path\":\"/hello-world\",\"toc\":false,\"type\":\"article\",\"html\":\"\"}]"}</script>
			<script>
				{
					__sveltekit_76tkyl = {
						base: new URL("..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					const data = [null,null];

					Promise.all([
						import("../_app/immutable/entry/start.D-aG5tYi.js"),
						import("../_app/immutable/entry/app.BHQ_ItW5.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 8],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
  </body>
</html>
